<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: jobPost.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: jobPost.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
const db = require('../database/db');

var service_categories = db.import('../database/models/service_categories.js');
var services = db.import('../database/models/services.js');
var jobs = db.import('../database/models/jobs');
/**
 * @function selectCategory
 * @param req {Object} - The request object coming from the client
 * @param res {Object} - The response object that will be sent to the client
 * @returns void
 */
exports.selectCategory = (req, res) => {

  try {
    db.sync({ force: false })
      .then(() => {
        return service_categories.findAll({ include: [] })
      })
      .then(selectCategories => {
        res.status(200).json(selectCategories);
      })

  } catch (e) {
    console.log(e);
    res.status(400);
  }

}


exports.selectService = (req, res) => {
  try {
    console.log(req);
    db.sync({ force: false })
      .then(() => {
        return services.findAll({ where: { category_id: req.body.id } });
      }).then(selectService => {
        res.status(200).json(selectService)
      })
  } catch (e) {
    console.log(e);
    res.status(400);
  }
}


exports.createNewJob = async (req, res) => {
  try {
    db.sync({ force: false })
      // sync database
      .then(() => {
        // create new jobDraft
        return jobs.create({
          client_id: req.body.client_id,
          service_type: req.body.service_type,
          service_id: req.body.service_id,
          client_type: req.body.client_type,
          status: "open",
          longitude: req.body.longitude,
          latitude: req.body.latitude,
          related_info: req.body.related_info
        });
      })
      .then(jobs => {
        return jobs.save();
      })
      .then(data => {
        res.status(201).json({ data });
      })
  }
  catch (e) {
    console.log(e);
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#selectCategory">selectCategory</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Thu Jun 11 2020 19:17:58 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
